# Nombre del flujo de trabajo
name: Compilar Tesis LaTeX a PDF

# Define cuándo se debe ejecutar
on:
  push:
    branches:
      - main # O la rama que uses como principal

# Define los trabajos (jobs) que se ejecutarán
jobs:
  build_latex:
    # El tipo de máquina virtual
    runs-on: ubuntu-latest

    # IMPORTANTE: Da permiso al workflow para crear un Release
    permissions:
      contents: write

    # La secuencia de pasos que realizará el trabajo
    steps:
      # Paso 1: Descarga una copia de tu repositorio
      - name: Checkout del Repositorio
        uses: actions/checkout@v4

      # Paso 2: Compila el archivo .tex para generar el PDF
      - name: Compilar documento LaTeX
        uses: xu-cheng/latex-action@v3
        with:
          root_file: main.tex
          compiler: latexmk

      # Paso 3: Crea o actualiza un Release con el PDF adjunto
      - name: Crear Release y adjuntar PDF
        uses: softprops/action-gh-release@v2
        with:
          # El nombre del tag que se creará o actualizará.
          # Al usar un nombre fijo, siempre se actualiza el mismo release.
          tag_name: tesis-pdf-automatico
          
          # El título que tendrá el Release en GitHub
          name: Tesis PDF (Compilación Automática ${{ github.run_number }})
          
          # El texto que aparecerá en la descripción del Release
          body: |
            PDF generado automáticamente a partir del último commit.
            Commit: `${{ github.sha }}`
          
          # Los archivos que quieres adjuntar. ¡Aquí está la magia!
          files: main.pdf